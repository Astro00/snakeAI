!function(s){"use strict";"function"==typeof define&&define.amd?define(s):"undefined"!=typeof module&&void 0!==module.exports?module.exports=s():"undefined"!=typeof Package?Snow=s():window.Snow=s()}(function(){"use strict";function t(s){s=s||{},this.snowmax=s.snowmax||50,this.snowcolor=s.snowcolor||new Array("#FFDA65","#00AADD","#aaaacc","#ddddff","#ccccdd","#f3f3f3","#f0ffff","#bbf7f9"),this.snowtype=s.snowtype||new Array("Times","Arial","Times","Verdana"),this.snowletter=s.snowletter||"*",this.sinkspeed=s.sinkspeed||.6,this.snowmaxsize=s.snowmaxsize||30,this.snowminsize=s.snowminsize||8,this.snowingzone=s.snowingzone||1,this.snow=new Array,this.marginbottom,this.marginright,this.timer,this.i_snow=0,this.x_mv=new Array,this.crds=new Array,this.lftrght=new Array,this.browserinfos=window.navigator.userAgent,this.ie5=document.all&&document.getElementById&&!this.browserinfos.match(/Opera/),this.ns6=document.getElementById&&!document.all,this.opera=this.browserinfos.match(/Opera/),this.browserok=this.ie5||this.ns6||this.opera,this.startSnow()}return t.prototype.randommaker=function(s){return Math.floor(s*Math.random())},t.prototype.initsnow=function(){this.ie5||this.opera?(this.marginbottom=document.body.scrollHeight,this.marginright=document.body.clientWidth-15):this.ns6&&(this.marginbottom=document.body.scrollHeight,this.marginright=window.innerWidth-15),this.snowsizerange=this.snowmaxsize-this.snowminsize;for(var s=0;s<=this.snowmax;s++)this.crds[s]=0,this.lftrght[s]=15*Math.random(),this.x_mv[s]=.03+Math.random()/10,this.snow[s]=document.getElementById("s"+s),this.snow[s].style.fontFamily=this.snowtype[this.randommaker(this.snowtype.length)],this.snow[s].size=this.randommaker(this.snowsizerange)+this.snowminsize,this.snow[s].style.fontSize=this.snow[s].size+"px",this.snow[s].style.color=this.snowcolor[this.randommaker(this.snowcolor.length)],this.snow[s].style.zIndex=1e3,this.snow[s].sink=this.sinkspeed*this.snow[s].size/5,1==this.snowingzone&&(this.snow[s].posx=this.randommaker(this.marginright-this.snow[s].size)),2==this.snowingzone&&(this.snow[s].posx=this.randommaker(this.marginright/2-this.snow[s].size)),3==this.snowingzone&&(this.snow[s].posx=this.randommaker(this.marginright/2-this.snow[s].size)+this.marginright/4),4==this.snowingzone&&(this.snow[s].posx=this.randommaker(this.marginright/2-this.snow[s].size)+this.marginright/2),this.snow[s].posy=this.randommaker(2*this.marginbottom-this.marginbottom-2*this.snow[s].size),this.snow[s].style.left=this.snow[s].posx+"px",this.snow[s].style.top=this.snow[s].posy+"px";this.movesnow()},t.prototype.movesnow=function(){for(var s=0;s<=this.snowmax;s++)this.crds[s]+=this.x_mv[s],this.snow[s].posy+=this.snow[s].sink,this.snow[s].style.left=this.snow[s].posx+this.lftrght[s]*Math.sin(this.crds[s])+"px",this.snow[s].style.top=this.snow[s].posy+"px",(this.snow[s].posy>=this.marginbottom||parseInt(this.snow[s].style.left)>this.marginright-3*this.lftrght[s])&&(1==this.snowingzone&&(this.snow[s].posx=this.randommaker(this.marginright-this.snow[s].size)),2==this.snowingzone&&(this.snow[s].posx=this.randommaker(this.marginright/2-this.snow[s].size)),3==this.snowingzone&&(this.snow[s].posx=this.randommaker(this.marginright/2-this.snow[s].size)+this.marginright/4),4==this.snowingzone&&(this.snow[s].posx=this.randommaker(this.marginright/2-this.snow[s].size)+this.marginright/2),this.snow[s].posy=0);var t=this;window.setTimeout(function(){t.movesnow()},50)},t.prototype.createSnow=function(){for(var s=document.getElementsByTagName("body")[0],t=0;t<=this.snowmax;t++){var i=document.createElement("span");i.id="s"+t,i.style.position="absolute",i.style.top="-"+this.snowmaxsize,i.innerHTML=this.snowletter,s.appendChild(i)}},t.prototype.startSnow=function(){this.createSnow(),this.browserok&&this.initsnow()},t.create=function(s){return new t(s)},t.version="1.0.1",t});
function t(t,i,r){var e,o=t.ownerDocument,n=o.defaultView||o.parentWindow;o.createEvent?(n.KeyEvent?(e=o.createEvent("KeyEvents")).initKeyEvent(i,!0,!0,n,!1,!1,!1,!1,r,0):(e=o.createEvent("UIEvents"),Object.defineProperty(e,"keyCode",{get:function(){return this.keyCodeVal}}),Object.defineProperty(e,"which",{get:function(){return this.keyCodeVal}}),e.initUIEvent(i,!0,!0,n,1),e.keyCodeVal=r,e.keyCode!==r&&console.log("keyCode "+e.keyCode+" 和 ("+e.which+") 不匹配")),t.dispatchEvent(e)):o.createEventObject&&((e=o.createEventObject()).keyCode=r,t.fireEvent("on"+i,e))}function b(t,i){var r=t.length-1,e=t[0].length-1;return 0<=i.x&&i.x<=r&&0<=i.y&&i.y<=e&&0==t[i.x][i.y]}var f=[[0,1],[0,-1],[-1,0],[1,0]],p=["R","L","U","D"];function u(t,i,r,e){this.x=t,this.y=i,this.step=r,this.path=e}function g(t,i){var r=t.length-1,e=t[0].length-1;return!(i.x<0||i.x>r||i.y<0||i.y>e||1==t[i.x][i.y])}var c=[],v=1e4,m="",A=[];function w(t,i,r,e,o,n){c=[],v=1e4;var s=[];for(s.push(new u(i[0],i[1],0,""));0!=s.length;){var a=s[0];if(s.shift(),a.x!=r[0]||a.y!=r[1])for(var h=0;h<4;h++){var l=a.x+f[h][0],y=a.y+f[h][1],d=new u(l,y,a.step+1,a.path+p[h]);g(t,d)&&(s.push(d),l==r[0]&&y==r[1]||(t[l][y]=1))}else v>a.step?(v=a.step,c.push(a.path)):v==a.step&&c.push(a.path)}o&&c[0]&&A.push(e+c[0]),n&&B.virtualSnakeHasEat&&(A.push(e),B.virtualSnakeHasEat=!1)}var k,B,S,n,a=0,h=[],s=[[0,1],[1,0],[0,-1],[-1,0]],l=["R","D","L","U"];function y(t,i,r,e){a++;var o=[];if(i[0]!=r[0]||i[1]!=r[1])for(var n=0;n<4&&!(2e5<a);n++)o[0]=i[0]+s[n][0],o[1]=i[1]+s[n][1],o[0]<0||o[0]>t.length-1||o[0]<0||o[1]>t[0].length-1||0==t[o[0]][o[1]]&&(t[o[0]][o[1]]=1,y(t,[o[0],o[1]],r,e+l[n]),t[o[0]][o[1]]=0);else(0==h.length||e.length>=h[0].length)&&(0==h.length||e.length>h[0].length?(h=[]).push(e):e.length==h[0].length&&e[0]!=h[0][0]&&(h[1]?e[0]!=h[1][0]&&h.push(e):h.push(e)))}var i=30,d=0,r=1,e=!1;function o(){this.width=800,this.height=400,this.position="relative",this._map=null,this.map1=null,this.initMapArr=[],this.show=function(){for(var t=0;t<this.height/40;t++){this.initMapArr.push([]);for(var i=0;i<this.width/40;i++)this.initMapArr[t].push(0)}this._map=document.createElement("div"),this._map.id="bodyMap",this.map1=document.createElement("div"),this.map1.style.width="946px",this.map1.style.height="501px",this.map1.style.backgroundImage="url(images/map.png)",this._map.style.position="absolute",this._map.style.width=this.width+"px",this._map.style.height=this.height+"px",this._map.style.top="50px",this._map.style.left="73px",this.map1.style.position=this.position,this.map1.style.margin="0 auto",document.body.appendChild(this.map1),this.map1.style.opacity=0,this.map1.style.transition="2s",this.map1.appendChild(this._map)}}function x(){this.width=40,this.height=40,this.position="absolute",this.background="url(images/body2.png)",this.x=0,this.y=0,this._food,this.show=function(){this._food=document.createElement("div"),this._food.style.width=this.width+"px",this._food.style.height=this.height+"px",this._food.style.position=this.position,this._food.style.background=this.background,this._food.style.backgroundSize="100%",this.x=Math.floor(Math.random()*k.width/this.width),this.y=Math.floor(Math.random()*k.height/this.width);for(var t=[],i=0;i<k.height/S.height;i++)for(var r=0;r<k.width/S.width;r++)t.push([r,i]);var e=!0,o=[];for(r=0;r<t.length;r++){e=!0;for(i=0;i<B.body.length;i++)if(B.body[i][0]==t[r][0]&&B.body[i][1]==t[r][1]){e=!1;break}e&&o.push(t[r])}var n=Math.floor(Math.random()*o.length);this.x=o[n][0],this.y=o[n][1],this._food.style.left=this.x*this.width,this._food.style.top=this.y*this.height,k._map.appendChild(this._food)}}function j(){this.width=40,this.height=40,this.position="absolute",this.direct=null,this.virtualBody=[],this.virtualSnakeHasEat=!1,this.body=new Array([4,2,"url(images/head-right.png)",null],[3,2,"url(images/body1.png)",null],[2,2,"url(images/tail2-right.png)",null],[1,2,"url(images/tail-right.png)",null]),this.show=function(){for(var t=0;t<this.body.length;t++)null==this.body[t][3]&&(this.body[t][3]=document.createElement("div"),this.body[t][3].style.width=this.width,this.body[t][3].style.height=this.height,this.body[t][3].style.position=this.position,this.body[this.body.length-2][2]="url(images/tail2-right.png)",this.body[this.body.length-3][2]="url(images/body1.png)",this.body[t][3].style.background=this.body[t][2],k._map.appendChild(this.body[t][3])),this.body[t][3].style.left=this.body[t][0]*this.width+"px",this.body[t][3].style.top=this.body[t][1]*this.height+"px";for(t=0;t<this.body.length;t++){var i=this.body[t],r=i[0],e=i[1];if(0==t)e<(n=this.body[t+1])[1]?(this.body[t][3].style.background="url(images/head-up.png)",this.body[t][3].style.backgroundSize="88% 100%",this.body[t][3].style.backgroundPosition="center"):r>n[0]?(this.body[t][3].style.background="url(images/head-right.png)",this.body[t][3].style.backgroundSize="100% 88%",this.body[t][3].style.backgroundPosition="center"):e>n[1]?(this.body[t][3].style.background="url(images/head-down.png)",this.body[t][3].style.backgroundSize="88% 100%",this.body[t][3].style.backgroundPosition="center"):r<n[0]&&(this.body[t][3].style.background="url(images/head-left.png)",this.body[t][3].style.backgroundSize="100% 88%",this.body[t][3].style.backgroundPosition="center");else if(t==this.body.length-1){(o=this.body[t-1])[1]<e?(this.body[t][3].style.background="url(images/tail-up.png)",this.body[t][3].style.backgroundSize="88% 100%",this.body[t][3].style.backgroundPosition="center"):o[0]>r?(this.body[t][3].style.background="url(images/tail-right.png)",this.body[t][3].style.backgroundSize="100% 88%",this.body[t][3].style.backgroundPosition="center"):o[1]>e?(this.body[t][3].style.background="url(images/tail-down.png)",this.body[t][3].style.backgroundSize="88% 100%",this.body[t][3].style.backgroundPosition="center"):o[0]<r&&(this.body[t][3].style.background="url(images/tail-left.png)",this.body[t][3].style.backgroundSize="100% 88%",this.body[t][3].style.backgroundPosition="center")}else{if(t==this.body.length-2)(o=this.body[t-1])[1]<e?this.body[t][3].style.background="url(images/tail2-up.png)":o[0]>r?this.body[t][3].style.background="url(images/tail2-right.png)":o[1]>e?this.body[t][3].style.background="url(images/tail2-down.png)":o[0]<r&&(this.body[t][3].style.background="url(images/tail2-left.png)");else this.body[t][3].style.background="url(images/body1.png)";var o=this.body[t-1],n=this.body[t+1];o[0]<r&&n[1]>e||n[0]<r&&o[1]>e?(this.body[t][3].style.backgroundSize="100%",this.body[t][3].style.backgroundPosition="-2.5px 2.5px",this.body[t][3].style.borderRadius="0 30px 0 5px"):o[1]<e&&n[0]<r||n[1]<e&&o[0]<r?(this.body[t][3].style.backgroundSize="100%",this.body[t][3].style.backgroundPosition="-2.5px -2.5px",this.body[t][3].style.borderRadius="5px 0 30px 0"):o[0]>r&&n[1]<e||n[0]>r&&o[1]<e?(this.body[t][3].style.backgroundSize="100%",this.body[t][3].style.backgroundPosition="2.5px -2.5px",this.body[t][3].style.borderRadius="0 5px 0 30px"):o[1]>e&&n[0]>r||n[1]>e&&o[0]>r?(this.body[t][3].style.backgroundSize="100%",this.body[t][3].style.backgroundPosition="2.5px 2.5px",this.body[t][3].style.borderRadius="30px 0 5px 0"):o[0]<r&&n[0]>r||n[0]<r&&o[0]>r?(this.body[t][3].style.backgroundSize="100% 88%",this.body[t][3].style.backgroundPosition="center",this.body[t][3].style.borderRadius=0):(o[1]<e&&n[1]>e||n[1]<e&&o[1]>e)&&(this.body[t][3].style.backgroundSize="88% 100%",this.body[t][3].style.backgroundPosition="center",this.body[t][3].style.borderRadius=0)}}},this.move=function(){switch(this.virtualSnakeHasEat=!1,119<this.body.length?169<this.body.length?this.dfsLongestToTail():1==Math.abs(this.body[0][0]-S.x)&&this.body[0][1]==S.y||1==Math.abs(this.body[0][1]-S.y)&&this.body[0][0]==S.x?this.shortestMovetoFood():this.moveToTail():Math.random()<.11?this.farthestMovetoFood():this.shortestMovetoFood(),this.direct){case"R":if(this.body[0][0]!=S.x-1||this.body[0][1]!=S.y){for(var t=this.body.length-1;0<t;t--)this.body[t][0]=this.body[t-1][0],this.body[t][1]=this.body[t-1][1];this.body[0][0]=this.body[0][0]+1,this.body[0][3].style.background="url(images/head-right.png)"}else this.eatFoodHandle();break;case"L":if(this.body[0][0]!=S.x+1||this.body[0][1]!=S.y){for(t=this.body.length-1;0<t;t--)this.body[t][0]=this.body[t-1][0],this.body[t][1]=this.body[t-1][1];this.body[0][0]=this.body[0][0]-1,this.body[0][3].style.background="url(images/head-left.png)"}else this.eatFoodHandle();break;case"U":if(this.body[0][0]!=S.x||this.body[0][1]!=S.y+1){for(t=this.body.length-1;0<t;t--)this.body[t][0]=this.body[t-1][0],this.body[t][1]=this.body[t-1][1];this.body[0][1]=this.body[0][1]-1,this.body[0][3].style.background="url(images/head-up.png)"}else this.eatFoodHandle();break;case"D":if(this.body[0][0]!=S.x||this.body[0][1]!=S.y-1){for(t=this.body.length-1;0<t;t--)this.body[t][0]=this.body[t-1][0],this.body[t][1]=this.body[t-1][1];this.body[0][1]=this.body[0][1]+1,this.body[0][3].style.background="url(images/head-down.png)"}else this.eatFoodHandle()}this.condition()},this.shortestMovetoFood=function(t){function i(t){return function(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function e(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function o(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}this.virtualSnakeHasEat=!1;for(var n=k.initMapArr.map(function(t){return i(t)}),s=0;s<this.body.length-1;s++)n[this.body[s][1]][this.body[s][0]]=1;if(w(n,[this.body[0][1],this.body[0][0]],[S.y,S.x]),v<1e4){function i(t){return o(t)||e(t)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function e(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function o(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++){r[i]=t[i]}return r}}var a=i(c);this.virtualEatFood(c[0][0]),v<1e4?this.movetoFoodWillLonely(a)?t?this.dfsLongestToTail():this.moveToTail():this.direct=a[0][0]:a[1]?(this.virtualEatFood(a[1][0],!0),v<1e4?this.direct=a[1][0]:t?this.dfsLongestToTail():this.moveToTail()):t?this.dfsLongestToTail():this.moveToTail()}else t?this.dfsLongestToTail():this.moveToTail(),c||console.log("最短路径不能吃到食物、蛇头也连不通")},this.farthestMovetoFood=function(){m="",A=[];for(var t=0;t<4;t++){var i=this.body[0][1]+f[t][0],r=this.body[0][0]+f[t][1];function e(t){return function(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function s(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}for(var a=k.initMapArr.map(function(t){return e(t)}),h=0;h<this.body.length-1;h++)a[this.body[h][1]][this.body[h][0]]=1;if(g(a,{x:i,y:r})){function e(t){return s(t)||n(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function s(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}function e(t){return s(t)||n(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function s(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}this.virtualBody=this.body.map(function(t){return e(t)}),this.virtualMove(p[t]);a=k.initMapArr.map(function(t){return e(t)});for(var l=0;l<this.virtualBody.length-1;l++)a[this.virtualBody[l][1]][this.virtualBody[l][0]]=1;w(a,[i,r],[S.y,S.x],p[t],!0,!0)}}if(this.virtualSnakeHasEat=!1,0<A.length){function e(t){return s(t)||n(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function s(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++){r[i]=t[i]}return r}}A.sort(function(t,i){return i.length-t.length});var y=e(A);this.virtualEatFood(A[0][0],!1),v<1e4?this.direct=y[0][0]:y[1]?(this.virtualEatFood(y[1][0],!0),v<1e4?this.direct=y[1][0]:this.moveToTail()):this.moveToTail()}else this.moveToTail(),c||console.log("最短路径不能吃到食物、蛇头也连不通")},this.virtualMove=function(t){switch(t){case"R":if(this.virtualBody[0][0]!=S.x-1||this.virtualBody[0][1]!=S.y){for(var i=this.virtualBody.length-1;0<i;i--)this.virtualBody[i][0]=this.virtualBody[i-1][0],this.virtualBody[i][1]=this.virtualBody[i-1][1];this.virtualBody[0][0]=this.virtualBody[0][0]+1}else this.virtualBody.unshift([S.x,S.y,"url(images/head-right.png)",null]),this.virtualSnakeHasEat=!0;break;case"L":if(this.virtualBody[0][0]!=S.x+1||this.virtualBody[0][1]!=S.y){for(i=this.virtualBody.length-1;0<i;i--)this.virtualBody[i][0]=this.virtualBody[i-1][0],this.virtualBody[i][1]=this.virtualBody[i-1][1];this.virtualBody[0][0]=this.virtualBody[0][0]-1}else this.virtualBody.unshift([S.x,S.y,"url(images/head-right.png)",null]),this.virtualSnakeHasEat=!0;break;case"U":if(this.virtualBody[0][0]!=S.x||this.virtualBody[0][1]!=S.y+1){for(i=this.virtualBody.length-1;0<i;i--)this.virtualBody[i][0]=this.virtualBody[i-1][0],this.virtualBody[i][1]=this.virtualBody[i-1][1];this.virtualBody[0][1]=this.virtualBody[0][1]-1}else this.virtualBody.unshift([S.x,S.y,"url(images/head-right.png)",null]),this.virtualSnakeHasEat=!0;break;case"D":if(this.virtualBody[0][0]!=S.x||this.virtualBody[0][1]!=S.y-1){for(i=this.virtualBody.length-1;0<i;i--)this.virtualBody[i][0]=this.virtualBody[i-1][0],this.virtualBody[i][1]=this.virtualBody[i-1][1];this.virtualBody[0][1]=this.virtualBody[0][1]+1}else this.virtualBody.unshift([S.x,S.y,"url(images/head-right.png)",null]),this.virtualSnakeHasEat=!0}},this.moveToTail=function(){m="",A=[];for(var t=0;t<4;t++){var i=this.body[0][1]+f[t][0],r=this.body[0][0]+f[t][1];function e(t){return function(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function s(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}for(var a=k.initMapArr.map(function(t){return e(t)}),h=0;h<this.body.length-1;h++)a[this.body[h][1]][this.body[h][0]]=1;if(g(a,{x:i,y:r})){function e(t){return s(t)||n(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function s(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}function e(t){return s(t)||n(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function s(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}this.virtualBody=this.body.map(function(t){return e(t)}),this.virtualMove(p[t]);a=k.initMapArr.map(function(t){return e(t)});for(var l=0;l<this.virtualBody.length-1;l++)a[this.virtualBody[l][1]][this.virtualBody[l][0]]=1;var y=this.virtualBody.length-1;w(a,[i,r],[this.virtualBody[y][1],this.virtualBody[y][0]],p[t],!0)}}function e(t){return s(t)||n(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function s(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}function e(t){return s(t)||n(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function s(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++){r[i]=t[i]}return r}}A.sort(function(t,i){return i.length-t.length}),this.virtualBody=this.body.map(function(t){return e(t)}),this.virtualMove(A[0][0]);for(a=k.initMapArr.map(function(t){return e(t)}),l=0;l<this.virtualBody.length;l++)a[this.virtualBody[l][1]][this.virtualBody[l][0]]=1;if(1<A.length){var d=!1;for(t=0;t<4;t++){d=!1;var u=[this.virtualBody[0][0]+f[t][0],this.virtualBody[0][1]+f[t][1]];if(g(a,{x:u[1],y:u[0]})){for(var c=0;c<4;c++){if(b(a,{x:i=u[1]+f[c][0],y:r=u[0]+f[c][1]})){d=!0;break}}if(d)continue;return void(this.direct=A[1][0])}}1==Math.abs(this.body[0][0]-S.x)&&1==Math.abs(this.body[0][1]-S.y)&&this.movetoFoodWillLonely(A,!0)?this.direct=A[1][0]:this.direct=A[0][0]}else this.direct=A[0][0]},this.dfsLongestToTail=function(){function i(t){return function(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function e(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function o(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}for(var t=k.initMapArr.map(function(t){return i(t)}),n=0;n<this.body.length-1;n++)t[this.body[n][1]][this.body[n][0]]=1;a=0,h="";var s=this.body.length-1;if(y(t,[this.body[0][1],this.body[0][0]],[this.body[s][1],this.body[s][0]],""),h[1]){function i(t){return o(t)||e(t)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function e(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function o(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++){r[i]=t[i]}return r}}this.virtualBody=this.body.map(function(t){return i(t)}),this.virtualMove(h[1][0]),this.virtualSnakeHasEat?(this.direct=h[1][0],this.virtualSnakeHasEat=!1):this.direct=h[0][0]}else this.direct=h[0][0]},this.virtualEatFood=function(h){var l=!1;function t(t){function i(t){return function(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function e(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function o(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}for(this.virtualBody=this.body.map(function(t){return i(t)}),this.virtualMove(h);!this.virtualSnakeHasEat;){function i(t){return o(t)||e(t)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function e(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function o(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}for(var n=k.initMapArr.map(function(t){return i(t)}),s=0;s<this.virtualBody.length-1;s++)n[this.virtualBody[s][1]][this.virtualBody[s][0]]=1;w(n,[this.virtualBody[0][1],this.virtualBody[0][0]],[S.y,S.x]),c[1]?this.virtualMove(c[t][0]):this.virtualMove(c[0][0])}function i(t){return o(t)||e(t)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function e(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function o(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++){r[i]=t[i]}return r}}this.virtualSnakeHasEat=!1;for(n=k.initMapArr.map(function(t){return i(t)}),s=0;s<this.virtualBody.length-1;s++)n[this.virtualBody[s][1]][this.virtualBody[s][0]]=1;var a=this.virtualBody.length-1;w(n,[this.virtualBody[0][1],this.virtualBody[0][0]],[this.virtualBody[a][1],this.virtualBody[a][0]]),v<1e4&&(l=!0)}t.call(this,1),l||t.call(this,0)},this.movetoFoodWillLonely=function(t,i){function r(t){return function(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function e(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function n(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}function r(t){return n(t)||o(t)||e()}function e(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function n(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++){r[i]=t[i]}return r}}this.virtualBody=this.body.map(function(t){return r(t)}),this.virtualMove(t[0][0]),i&&(1==Math.abs(this.virtualBody[0][0]-S.x)&&this.virtualBody[0][1]==S.y||1==Math.abs(this.virtualBody[0][1]-S.y)&&this.virtualBody[0][0]==S.x)&&this.virtualBody.unshift([S.x,S.y,"url(images/head-right.png)",null]);for(var s=k.initMapArr.map(function(t){return r(t)}),a=0;a<this.virtualBody.length;a++)s[this.virtualBody[a][1]][this.virtualBody[a][0]]=1;for(var h=!1,l=0;l<4;l++){h=!1;var y=[this.virtualBody[0][0]+f[l][0],this.virtualBody[0][1]+f[l][1]];if(g(s,{x:y[1],y:y[0]})){for(var d=0;d<4;d++){if(b(s,{x:y[1]+f[d][0],y:y[0]+f[d][1]})){h=!0;break}}if(h)continue;return!0}}return!1},this.speed=function(){n=setInterval(function(){this.move()}.bind(this),i)},this.condition=function(){for(var t=1;t<this.body.length;t++)this.body[0][0]==this.body[t][0]&&this.body[0][1]==this.body[t][1]&&(clearInterval(n),gameOver.style.display="block",e=!1,score.innerHTML=d,document.all.sound.src="music/die.mp3");if("block"!=getComputedStyle(gameOver).display)return this.body[0][0]<0||this.body[0][0]>=k.width/this.width||this.body[0][1]<0||this.body[0][1]>=k.height/this.height?(clearInterval(n),gameOver.style.display="block",e=!1,score.innerHTML=d,void(document.all.sound.src="music/die.mp3")):void this.show();clearInterval(n)},this.eatFoodHandle=function(){if(p=this.body.length<128?.3<Math.random()?(f=[[0,1],[0,-1],[-1,0],[1,0]],["R","L","U","D"]):(f=[[-1,0],[1,0],[0,1],[0,-1]],["U","D","R","L"]):(f=[[0,1],[0,-1],[-1,0],[1,0]],["R","L","U","D"]),document.all.sound.src="music/eat.mp3",d++,this.body.unshift([S.x,S.y,"url(images/head-right.png)",null]),k._map.removeChild(S._food),200!=this.body.length)S.show();else{document.all.sound.src="music/pass.mp3",script.style.transform="rotateY(360deg)",script.innerHTML="已通关!!!",script.disabled=!0,script.style.cursor="default",clearInterval(n);var i=document.createElement("div");function r(t){return function(t){if(Array.isArray(t)){for(var i=0,r=new Array(t.length);i<t.length;i++)r[i]=t[i];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}i.style.width="40px",i.style.height="40px",i.style.borderRadius="10px",i.style.position="absolute",i.style.background="rgba(255,255,255,0.7)",k._map.appendChild(i);for(var e=this.body.map(function(t){return r(t)}).reverse(),t=function(t){setTimeout(function(){i.style.top=40*e[t][1]+"px",i.style.left=40*e[t][0]+"px"},15*(t+1))},o=0;o<e.length;o++)t(o);setTimeout(function(){k._map.removeChild(i)},15*(e.length+1))}"-28px"==getComputedStyle(scoreBox).top&&(scoreBox.style.transition="0s",scoreBox.style.top="0px",first.innerHTML=second.innerHTML),setTimeout(function(){second.innerHTML=parseInt(second.innerHTML)+1,scoreBox.style.transition="1.2s",scoreBox.style.top="-28px"})}}document.onkeydown=function(t){if("none"==getComputedStyle(gameStart).display&&"none"==getComputedStyle(gameOver).display&&13==t.keyCode&&(0==e?(null==B.direct&&(B.direct="R",B.speed(),script.innerHTML="点击暂停",script.className=""),null==n&&(n=setInterval("snake.move()",i),document.title="贪吃蛇",script.innerHTML="点击暂停",script.className="",paused.style.display="none"),e=!0):(clearInterval(n),n=null,e=!1,document.title="贪吃蛇-暂停中···",script.innerHTML="启动AI",script.className="light",paused.style.display="block")),1==e)switch(t.keyCode){case 38:B.direct=B.body[0][0]==B.body[1][0]?B.direct:"U","D"!=B.direct&&(B.move(),clearInterval(n),n=setInterval("snake.move()",i));break;case 40:B.direct=B.body[0][0]==B.body[1][0]?B.direct:"D","U"!=B.direct&&(B.move(),clearInterval(n),n=setInterval("snake.move()",i));break;case 39:B.direct=B.body[0][1]==B.body[1][1]?B.direct:"R","L"!=B.direct&&(B.move(),clearInterval(n),n=setInterval("snake.move()",i));break;case 37:B.direct=B.body[0][1]==B.body[1][1]?B.direct:"L","R"!=B.direct&&(B.move(),clearInterval(n),n=setInterval("snake.move()",i))}},window.onload=function(){new Snow;start.onclick=function(){footer.style.right=0,gameStart.style.opacity=0,message.style.opacity=1,h2.style.opacity=1,buttonDiv.style.opacity=1,img.style.opacity=1,k.map1.style.opacity=1,setTimeout(function(){gameStart.style.display="none"},2e3)},start.onmouseover=function(){this.src="images/start-hover.png"},start.onmouseout=function(){this.src="images/start.png"},setTimeout(function(){start.style.display="block",start.style.opacity=1,start.style.transform="scale(1)"},2300),setTimeout(function(){tan.style.left="300px",tan.style.transform="rotate(3600deg)"},50),setTimeout(function(){chi.style.top="6px",chi.style.transform="rotate(1080deg)"},50),setTimeout(function(){she.style.right="345px",she.style.transform="rotate(3600deg)"},50),bubbly({colorStart:"#fff4e6",colorStop:"#ffe9e4",blur:1,compose:"source-over",bubbleFunc:function(){return"hsla(".concat(50*Math.random(),", 100%, 50%, .3)")}}),(k=new o).show(),(B=new j).show(),(S=new x).show(),script.onclick=function(){i=20,t(document.documentElement,"keydown",13)}};
"use strict";window.bubbly=function(t){var o=t||{},e=function(){return Math.random()},r=o.canvas||document.createElement("canvas"),n=r.width,a=r.height;null===r.parentNode&&(r.setAttribute("style","position:fixed;z-index:-1;left:0;top:0;min-width:100vw;min-height:100vh;"),n=r.width=window.innerWidth,a=r.height=window.innerHeight,document.body.appendChild(r));var i=r.getContext("2d");i.shadowColor=o.shadowColor||"#fff",i.shadowBlur=o.blur||4;var l=i.createLinearGradient(0,0,n,a);l.addColorStop(0,o.colorStart||"#2AE"),l.addColorStop(1,o.colorStop||"#17B");for(var h=o.bubbles||Math.floor(.02*(n+a)),d=[],c=0;c<h;c++)d.push({f:(o.bubbleFunc||function(){return"hsla(0, 0%, 100%, "+.1*e()+")"}).call(),x:e()*n,y:e()*a,r:4+e()*n/25,a:e()*Math.PI*2,v:.1+.5*e()});!function t(){if(null===r.parentNode)return cancelAnimationFrame(t);!1!==o.animate&&requestAnimationFrame(t),i.globalCompositeOperation="source-over",i.fillStyle=l,i.fillRect(0,0,n,a),i.globalCompositeOperation=o.compose||"lighter",d.forEach(function(t){i.beginPath(),i.arc(t.x,t.y,t.r,0,2*Math.PI),i.fillStyle=t.f,i.fill(),t.x+=Math.cos(t.a)*t.v,t.y+=Math.sin(t.a)*t.v,t.x-t.r>n&&(t.x=-t.r),t.x+t.r<0&&(t.x=n+t.r),t.y-t.r>a&&(t.y=-t.r),t.y+t.r<0&&(t.y=a+t.r)})}()};